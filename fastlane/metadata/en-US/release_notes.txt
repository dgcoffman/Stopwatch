The first and best version. Adds all functionality.
